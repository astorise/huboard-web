{{#if showModal}}
  {{#x-modal}}
    {{component currentModal model=modalModel close='closeModal'}}
  {{/x-modal}}
{{/if}}

<div class="alert {{if errorState 'alert-error' 'alert-success'}}">
  <div class={{if trialing 'trialing' 'disabled'}}>
    <p><strong> Free Trial is Active! </strong></p>
    <p>Expires: {{stripe-date plan.trial_end}}</p>
  </div>
  <div class={{if trialingExpired 'trialing-expired' 'disabled'}}>
    <p><strong> Free Trial is Expired! </strong></p>
    <p> Upgrade your plan to enable private access </p>
  </div>


  <div class={{if noAccount 'new-account' 'disabled'}}>
    <p>
      <strong>All Accounts</strong> receive a <strong>15 day free trial</strong>.
    </p>
    <p>
      <form {{action "activateTrial" on="submit"}}>
        {{input type="email" placeholder="Email Address" name="billing_email" value=emailBinding required="required"}}
        {{input class="hb-button" type="submit" value="Activate Trial" disabled=trialButtonDisabled}}
      </form>
    </p>
  </div>
  <div class={{if active 'active' 'disabled'}}>
    <p><strong> Subscription Active </strong></p>
  </div>
  <div class={{if inactive 'active' 'disabled'}}>
    <p><strong> No Subscription Active </strong></p>
  </div>
  <div class={{if nonProfit 'active' 'disabled'}}>
    <p><strong> Non-Profit Subscription </strong></p>
  </div>
  <div class={{if failure 'active' 'disabled'}}>
    <p><strong> Something went wrong retrieving your account information!
    </strong></p>
    <p> 
      Please try again later, or <a href="mailto:support@huboard.com">Contact Support </a>
    </p>
  </div>
  <div class={{if purchaseWithTrial 'active' 'disabled'}}>
    <p><strong> Subscription Active! </strong></p>
    <p> 
      As your trial is still in effect, you will not be charged until: {{stripe-date plan.trial_end}}
    </p>
  </div>
</div>
<div class='account-details'>
  <div class='email'>
    {{#if model.details.account_email}}
      <strong>Email: </strong>{{model.details.account_email}} 
      <button style="float: right" {{action 'updateEmail' model }} class="hb-button small">Update Email</button>
    {{/if}}
  </div>
  <div class='credit-card'>
    {{#if model.details.card }}
     <img src="/assets/images/Plain.png" /> <strong>Credit card on file.</strong> Ending in {{ model.details.card.last4 }}
     <button style="float: right" {{action 'updateCard' model}} class="hb-button small">Update card</button>
    {{else}}
      <img src="/assets/images/Plain.png" /> <strong>No Credit card on file.</strong>
    {{/if}}
  </div>

  <div class='coupon'>
    {{#if model.details.has_plan }}
      <img src="/assets/images/icn-coupon.png" /> <strong> Coupon: {{{couponCode}}} </strong>
    <button style="float: right"class="hb-button small"
    {{action 'applyCoupon' model}}> Redeem Coupon </button>
    {{/if}}
  </div>
</div>
 <div class="table-wrapper">
  <table class="table">
    <thead>
      <th>Plan</th>
      <th>Price</th>
      <th>Private repositories</th>
      <th>Collaborators</th>
      <th></th>
    </thead>
    <tbody>

      {{#each model.details.plans as |plan| }}
      <tr>
        <td>{{ plan.name }}</td>
        <td>{{stripe-money plan.amount }}/month</td>
        <td>unlimited</td>
        <td>unlimited</td>
        <td class="text-right">    
         {{#if plan.purchased }} 
            Your plan
            <button class="hb-button hb-button-danger small"
               {{action 'cancel' plan}}>Cancel plan</button>
          {{else}}
            <button class="hb-button small"
             {{action 'purchase' plan}}>Upgrade</button>
          {{/if}}

        </td>
      </tr>

      {{/each}}
    </tbody>
  </table>
</div>

